<div class="todo-box" scope>
    <h1 s-i18n="todo"></h1>

    <div 
        c-show="todolist?.length > 0" 
        s:todolist="services.task.getAll()"
    >
        <div 
            c-show="todolist"
            c-for="(item, key) in todolist"
            class="todo-item"
        >
            <input type="checkbox" c-model="item.checked"></checkbox>

            <label>{{ item.label }}</label>
        </div>
    </div>

    <div class="todo-input-box">
        <input v-model="label" class="todo-input">

        <button 
            class="todo-btn"
            s-i18n="add" 
            @click="add"
        ></button>
    </div>

    <pre>{{ todolist }}</pre>
</div>

<script s-setup>
export default {
    layout: "default",

    head: {
        meta: [
            { name: "description", content: "CMMV Todolist sample" },
            { name: "keywords", content: "cmmv, contract model, websocket" }
        ],
        link: [
            { rel: "stylesheet", href: "/assets/styles/todo.css" },
            { rel: "canonical", href: "https://cmmv.io" },
        ]
    },

    data(){
        return {
            tt: true,
            todolist: [],
            label: ""
        }
    },

    mounted() {      
        this.rpc.on('tasks', this.updateList);
    },

    methods: {
        add(){
            this.rpc.add('tasks', { label: this.label });
            this.label = '';
        },

        updateList(data) {
            this.todolist = data;
        }   
    }
}
</script>

        